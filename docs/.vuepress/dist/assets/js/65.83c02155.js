(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{718:function(s,t,a){"use strict";a.r(t);var n=a(26),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_11-jvm性能调优-一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-jvm性能调优-一"}},[s._v("#")]),s._v(" 11.JVM性能调优（一）")]),s._v(" "),a("h2",{attrs:{id:"_11-1-压测工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-压测工具"}},[s._v("#")]),s._v(" 11.1 压测工具")]),s._v(" "),a("p",[s._v("AB Ab(ApacheBench) 测试工具是 Apache 提供的一款测试工具，具有简单易上手的特点，在测试 Web 服务时非常实用。"),a("br"),s._v("\nab 一般都是在 Linux 上用。 安装非常简单，只需要在 Linux 系统中输入")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("// 安装命令\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" httpd-tools\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("安装成功后，输入 ab 命令，可以看到以下信息：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ab")]),s._v("\nab: wrong number of arguments\nUsage: ab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("://"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("hostname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("/path\nOptions are:\n    -n requests     Number of requests to perform\n    -c concurrency  Number of multiple requests to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" at a "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v("\n    -t timelimit    Seconds to max. to spend on benchmarking\n                    This implies -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50000")]),s._v("\n    -s "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v("      Seconds to max. "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wait")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each response\n                    Default is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" seconds\n    -b windowsize   Size of TCP send/receive buffer, "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" bytes\n    -B address      Address to "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" to when making outgoing connections\n    -p postfile     File containing data to POST. Remember also to "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -T\n    -u putfile      File containing data to PUT. Remember also to "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -T\n    -T content-type Content-type header to use "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" POST/PUT data, eg.\n                    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'application/x-www-form-urlencoded'")]),s._v("\n                    Default is "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/plain'")]),s._v("\n    -v verbosity    How much troubleshooting info to print\n    -w              Print out results "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" HTML tables\n    -i              Use HEAD instead of GET\n    -x attributes   String to insert as table attributes\n    -y attributes   String to insert as "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr")]),s._v(" attributes\n    -z attributes   String to insert as td or th attributes\n    -C attribute    Add cookie, eg. "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Apache=1234'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("repeatable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    -H attribute    Add Arbitrary header line, eg. "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Accept-Encoding: gzip'")]),s._v("\n                    Inserted after all normal header lines. "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("repeatable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    -A attribute    Add Basic WWW Authentication, the attributes\n                    are a colon separated username and password.\n    -P attribute    Add Basic Proxy Authentication, the attributes\n                    are a colon separated username and password.\n    -X proxy:port   Proxyserver and port number to use\n    -V              Print version number and "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n    -k              Use HTTP KeepAlive feature\n    -d              Do not show percentiles served table.\n    -S              Do not show confidence estimators and warnings.\n    -q              Do not show progress when doing "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" than "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("150")]),s._v(" requests\n    -l              Accept variable document length "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("use this "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" dynamic pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    -g filename     Output collected data to gnuplot "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("format")]),s._v(" file.\n    -e filename     Output CSV "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" with percentages served\n    -r              Don't "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" on socket receive errors.\n    -m method       Method name\n    -h              Display usage information "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("this message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    -I              Disable TLS Server Name Indication "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SNI"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" extension\n    -Z ciphersuite  Specify SSL/TLS cipher suite "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("See openssl ciphers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    -f protocol     Specify SSL/TLS protocol\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SSL2, TLS1, TLS1.1, TLS1.2 or ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    -E certfile     Specify optional client certificate chain and private key\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br")])]),a("p",[s._v("ab 工具用来测试 post get 接口请求非常便捷，可以通过参数指定请求数、并发数、请求参数等")]),s._v(" "),a("p",[a("strong",[s._v("测试get")]),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[s._v("ab -c 10 -n 100 http://www.test.api.com/test/login?userName=test&password=test ")])],1),s._v(" "),a("p",[a("strong",[s._v("测试post")]),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[s._v("ab -n 100 -c 10 -p 'post.txt' -T 'application/x-www-form-urlencoded' 'http://test.api.com/test/register'")])],1),s._v(" "),a("h3",{attrs:{id:"_11-1-1-输入参数的含义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-1-输入参数的含义"}},[s._v("#")]),s._v(" 11.1.1 输入参数的含义")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("参数的含义")]),s._v(" "),a("p",[s._v("post.txt 为存放 post 参数的文档，存储格式如 usernanme=test&password=test&sex=1\n"),a("font",{attrs:{color:"red"}},[a("strong",[s._v("-n")])]),s._v(" ：总请求次数（最小默认为 1）"),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("-c")])]),s._v(" ：并发次数（最小默认为 1 且不能大于总请求次数，例如：10 个请求，10 个并发，实际就是 1 人请求 1 次）"),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("-p")])]),s._v(" ：post 参数文档路径（-p 和 -T 参数要配合使用）"),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("-T")])]),s._v(" ：header 头内容类型（此处切记是大写英文字母 T）")],1)]),s._v(" "),a("h3",{attrs:{id:"_11-1-2-输出性能指标参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-2-输出性能指标参考"}},[s._v("#")]),s._v(" 11.1.2 输出性能指标参考")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("输出性能指标参考")]),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[a("strong",[s._v("Requests per second")])]),s._v("：吞吐率，指某个并发用户数下单位时间内处理的请求数；"),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("Time per request")])]),s._v("：上面的是用户平均请求等待时间，指处理完成所有请求数所花费的时间 /（总请求数 / 并发用户数）；"),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("Time per request")])]),s._v("：下面的是服务器平均请求处理时间，指处理完成所有请求数所花费的时间 / 总请求数；"),a("br"),s._v(" "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("Percentage of the requests served within a certain time")])]),s._v("：每秒请求时间分布情况，指在整个请求中，每个请求的时间长度的分布情况，例如有 50% 的请求 响应在 8ms 内，66% 的请求响应在 10ms 内，说明有 16% 的请求在 8ms~10ms 之间")],1)]),s._v(" "),a("h2",{attrs:{id:"_11-2-jvm-内存分配的调优案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-2-jvm-内存分配的调优案例"}},[s._v("#")]),s._v(" 11.2 JVM 内存分配的调优案例")]),s._v(" "),a("p",[s._v("一个高并发系统中的抢购接口，高峰时 5W 的并发请求，且每次请求会产生 20KB 对象（包括订单、用户、优惠券等对象数据）。 我们可以通过一个并发创建一个 1MB 对象的接口来模拟万级并发请求产生大量对象的场景，具体代码如下：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/jvm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JvmTestController")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/heap"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestMethod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("jvmTest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" list"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" b"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jvmtest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"success"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("strong",[s._v("启动项目")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java -jar demo-0.0.1-SNAPSHOT.jar ")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("   ____          _            __ _ _\n /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" / ___"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '")]),s._v("_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'_| | '")]),s._v("_ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("/ _` "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("/  ___"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::        (v2.2.2.RELEASE)\n\n2021-07-29 23:58:34.263  INFO 2769452 --- [           main] com.example.demo.DemoApplication         : Starting DemoApplication v0.0.1-SNAPSHOT on TXYUN-NO3 with PID 2769452 (/root/JVMTEST/demo-0.0.1-SNAPSHOT.jar started by root in /root/JVMTEST)\n2021-07-29 23:58:34.282  INFO 2769452 --- [           main] com.example.demo.DemoApplication         : No active profile set, falling back to default profiles: default\n2021-07-29 23:58:37.718  INFO 2769452 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9090 (http)\n2021-07-29 23:58:37.765  INFO 2769452 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\n2021-07-29 23:58:37.766  INFO 2769452 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.29]\n2021-07-29 23:58:38.043  INFO 2769452 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\n2021-07-29 23:58:38.044  INFO 2769452 --- [           main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 3526 ms\n2021-07-29 23:58:39.198  INFO 2769452 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService '")]),s._v("applicationTaskExecutor"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n2021-07-29 23:58:39.817  INFO 2769452 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9090 (http) with context path '")]),s._v("'\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":58:39.819  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2769452")]),s._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("           main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" com.example.demo.DemoApplication         "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Started DemoApplication "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.811")]),s._v(" seconds "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("JVM running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.691")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":59:06.488  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2769452")]),s._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("nio-9090-exec-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" o.a.c.c.C."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Tomcat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Initializing Spring DispatcherServlet "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dispatcherServlet'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":59:06.488  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2769452")]),s._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("nio-9090-exec-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" o.s.web.servlet.DispatcherServlet        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Initializing Servlet "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dispatcherServlet'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":59:06.505  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2769452")]),s._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("nio-9090-exec-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" o.s.web.servlet.DispatcherServlet        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Completed initialization "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" ms\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h2",{attrs:{id:"_11-3-ab-压测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-3-ab-压测"}},[s._v("#")]),s._v(" 11.3 AB 压测")]),s._v(" "),a("p",[s._v("对应用服务进行压力测试，模拟不同并发用户数下的服务的响应情况：")]),s._v(" "),a("ol",[a("li",[s._v("10 个并发用户/10 万请求量(总)   ab -c 10 -n 100000 http://127.0.0.1:8080/jvm/heap")]),s._v(" "),a("li",[s._v("100 个并发用户/10 万请求量(总)  ab -c 100 -n 100000 http://127.0.0.1:8080/jvm/heap")]),s._v(" "),a("li",[s._v("1000 个并发用户/10 万请求量(总) ab -c 1000 -n 100000 http://127.0.0.1:8080/jvm/heap")])]),s._v(" "),a("p",[a("strong",[s._v("服务器信息1C2G…")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# free -h")]),s._v("\n              total        used        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("      shared  buff/cache   available\nMem:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".8Gi       633Mi       153Mi       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0Mi       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0Gi       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0Gi\nSwap:            0B          0B          0B\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# cat /proc/cpuinfo |grep "cores"|uniq')]),s._v("\ncpu cores\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_11-4-gc-监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-4-gc-监控"}},[s._v("#")]),s._v(" 11.4 GC 监控")]),s._v(" "),a("p",[s._v("无监控不调优，所以我们需要监控起来。JVM 中我们使用 jstat 命令监控一下 JVM 的GC情况。 统计 GC 的情况：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jps ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2769452")]),s._v(" jar\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2773445")]),s._v(" Jps\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jstat -gc 2769452 5000 20 | awk '{print $13,$14,$15,$16,$17}'")]),s._v("\nYGC YGCT FGC FGCT GCT\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.171")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.171")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.171")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.171")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.171")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.171")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"_11-5-堆空间监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-5-堆空间监控"}},[s._v("#")]),s._v(" 11.5 堆空间监控")]),s._v(" "),a("p",[s._v("在默认不配置 JVM 堆内存大小的情况下，JVM 根据默认值来配置当前内存大小。 我们可以通过以下命令来查看堆内存配置的默认值："),a("br"),s._v(" "),a("strong",[s._v("java -XX:+PrintFlagsFinal -version | grep HeapSize")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java -XX:+PrintFlagsFinal -version | grep HeapSize")]),s._v("\n    uintx ErgoHeapSizeLimit                         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    uintx HeapSizePerGCThread                       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87241520")]),s._v("                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    uintx InitialHeapSize                          :"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31457280")]),s._v("                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    uintx LargePageHeapSizeThreshold                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217728")]),s._v("                           "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    uintx MaxHeapSize                              :"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("480247808")]),s._v("                           "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\njava version "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.8.0_211"')]),s._v("\nJava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" SE Runtime Environment "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".0_211-b12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nJava HotSpot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-Bit Server VM "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.211")]),s._v("-b12, mixed mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("JVM 默认最大堆内存为 480MB，初始化大小为 32MB"),a("br"),s._v(" "),a("strong",[s._v("使用 jmap -heap <pid> 这种方式，我们看到这个 JVM 应用占据的堆空间大小")]),s._v("\njmap -heap  2769452")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("root@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jmap -heap  2769452")]),s._v("\nAttaching to process ID "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2769452")]),s._v(", please wait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nDebugger attached successfully.\nServer compiler detected.\nJVM version is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.211")]),s._v("-b12\n\nusing thread-local object allocation.\nMark Sweep Compact GC\n\nHeap Configuration:\n   MinHeapFreeRatio         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\n   MaxHeapFreeRatio         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\n   MaxHeapSize              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("480247808")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("458")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   NewSize                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10485760")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   MaxNewSize               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("160038912")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("152")]),s._v(".625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   OldSize                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20971520")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   NewRatio                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   SurvivorRatio            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n   MetaspaceSize            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21807104")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".796875MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   CompressedClassSpaceSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073741824")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   MaxMetaspaceSize         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17592186044415")]),s._v(" MB\n   G1HeapRegionSize         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nHeap Usage:\nNew Generation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Eden + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" Survivor Space"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9502720")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".0625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6891048")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".571815490722656MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2611672")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".4906845092773438MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("72.51658472521552")]),s._v("% used\nEden Space:\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8454144")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".0625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6357008")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".0625152587890625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097136")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".9999847412109375MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75.19398770591086")]),s._v("% used\nFrom Space:\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("534040")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".5093002319335938MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("514536")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".49069976806640625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50.930023193359375")]),s._v("% used\nTo Space:\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("% used\ntenured generation:\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20971520")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10445832")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".961921691894531MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10525688")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(".038078308105469MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("49.809608459472656")]),s._v("% used\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11316")]),s._v(" interned Strings occupying "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("957152")]),s._v(" bytes.\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br")])]),a("h2",{attrs:{id:"_11-6-压测方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-6-压测方案"}},[s._v("#")]),s._v(" 11.6 压测方案")]),s._v(" "),a("h3",{attrs:{id:"_11-6-1-直接使用默认jvm参数运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-6-1-直接使用默认jvm参数运行"}},[s._v("#")]),s._v(" 11.6.1  直接使用默认jvm参数运行")]),s._v(" "),a("p",[s._v("java -jar  demo-1.0-SNAPSHOT.jar")]),s._v(" "),a("p",[s._v("ab -c 10 -n 100000 http://1.117.13.88:9090/jvm/heap")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ab -c 10 -n 100000 http://1.117.13.88:9090/jvm/heap")]),s._v("\nThis is ApacheBench, Version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Revision")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1843412")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nCopyright "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1996")]),s._v(" Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.117")]),s._v(".13.88 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("be patient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("70000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90000")]),s._v(" requests\nCompleted "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000")]),s._v(" requests\nFinished "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000")]),s._v(" requests\n\n\nServer Software:        \nServer Hostname:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.117")]),s._v(".13.88\nServer Port:            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v("\n\nDocument Path:          /jvm/heap\nDocument Length:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" bytes\n\nConcurrency Level:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nTime taken "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" tests:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("761.489")]),s._v(" seconds\nComplete requests:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000")]),s._v("\nFailed requests:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nTotal transferred:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13900000")]),s._v(" bytes\nHTML transferred:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("700000")]),s._v(" bytes\nRequests per second:    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("131.32")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/sec] (mean)")]),s._v("\nTime per request:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("76.149")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTime per request:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.615")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mean, across all concurrent requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTransfer rate:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17.83")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Kbytes/sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" received\n\nConnection Times "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              min  mean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("+/-sd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" median   max\nConnect:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("187.4")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7150")]),s._v("\nProcessing:     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253.9")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12593")]),s._v("\nWaiting:        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253.0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12593")]),s._v("\nTotal:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("321.8")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12597")]),s._v("\n\nPercentage of the requests served within a certain "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("%     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("66")]),s._v("%     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v("%     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("%     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v("%     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),s._v("%    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("229")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("98")]),s._v("%   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1056")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v("%   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1689")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12597")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("longest request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nroot@TXYUN-NO3 JVMTEST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jstat -gc 2769452 5000 20 | awk '{print $13,$14,$15,$16,$17}'")]),s._v("\nYGC YGCT FGC FGCT GCT\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16384")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27.951")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.305")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28.257")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16622")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28.298")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28.673")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16873")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28.677")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29.052")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17140")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29.038")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29.413")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17453")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29.444")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29.819")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17737")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29.798")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.172")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.268")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.642")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18445")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.711")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.085")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18764")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.099")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.473")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19144")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.587")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.962")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19425")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.947")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32.321")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19881")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32.537")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32.912")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20137")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32.853")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33.228")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20505")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33.314")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33.689")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20815")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33.775")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.150")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21171")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.187")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.561")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21492")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.580")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.954")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21822")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.977")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.351")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21979")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.168")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.542")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22283")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.544")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.375")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.918")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br")])]),a("p",[s._v("ab -c 10 -n 100000 http://1.117.13.88:9090/jvm/heap")]),s._v(" "),a("h3",{attrs:{id:"_11-6-2-增大堆内存空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-6-2-增大堆内存空间"}},[s._v("#")]),s._v(" 11.6.2 增大堆内存空间")]),s._v(" "),a("p",[a("strong",[s._v("java -jar -Xms1500m -Xmx1500m demo-1.0-SNAPSHOT.jar")])]),s._v(" "),a("p",[s._v("使用 AB 进行压力测试： ab -c 10 -n 100000 http://1.117.13.88:9090/jvm/heap")]),s._v(" "),a("h3",{attrs:{id:"_11-6-3-增大堆内存新生代比例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-6-3-增大堆内存新生代比例"}},[s._v("#")]),s._v(" 11.6.3 增大堆内存新生代比例")]),s._v(" "),a("p",[a("strong",[s._v("java -jar -Xms1500m -Xmx1500m -Xmn1000m -XX:SurvivorRatio=8 demo-1.0-SNAPSHOT.jar")])]),s._v(" "),a("p",[s._v("使用 AB 进行压力测试： ab -c 10 -n 100000 http://1.117.13.88:9090/jvm/heap")]),s._v(" "),a("h2",{attrs:{id:"_11-7-gc-调优策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-7-gc-调优策略"}},[s._v("#")]),s._v(" 11.7 GC 调优策略")]),s._v(" "),a("h3",{attrs:{id:"_11-7-1-降低-minor-gc-频率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-7-1-降低-minor-gc-频率"}},[s._v("#")]),s._v(" 11.7.1 降低 Minor GC 频率")]),s._v(" "),a("p",[s._v("由于新生代空间较小，Eden 区很快被填满，就会导致频繁 Minor GC，因此我们可以通过增大新生代空间来降低 Minor GC 的频率。 单次 Minor GC 时间是由两部分组成：T1（扫描新生代）和 T2（复制存活对象）。")]),s._v(" "),a("p",[s._v("情况 1：假设一个对象在 Eden 区的存活时间为 500ms，Minor GC 的时间间隔是 300ms，因为这个对象存活时间>间隔时间，那么正常情况下，Minor GC 的时间为 ：T1+T2。")]),s._v(" "),a("p",[s._v("情况 2：当我们增大新生代空间，Minor GC 的时间间隔可能会扩大到 600ms，此时一个存活 500ms 的对象就会在 Eden 区中被回收掉，此时就不 存在复制存活对象了，所以再发生 Minor GC 的时间为：即 T1"),a("em",[s._v("2（空间大了）+T2")]),s._v("0 可见，扩容后，Minor GC 时增加了 T1，但省去了 T2 的时间。")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("在 JVM 中，复制对象的成本要远高于扫描成本。"),a("br"),s._v("\n如果在堆内存中存在较多的长期存活的对象，此时增加年轻代空间，反而会增加 Minor GC 的时间。如 果堆中的短期对象很多，那么扩容新生代，单次 Minor GC 时间不会显著增加。")]),s._v(" "),a("p",[s._v("因此，单次 Minor GC 时间更多取决于 GC 后存活对象的数量，而非 Eden 区的大小。 这个就解释了之前的内存调整方案中，方案一为什么性能还差些，但是到了方案二话，性能就有明显的上升。")]),s._v(" "),a("h3",{attrs:{id:"_11-7-1-降低-full-gc-的频率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-7-1-降低-full-gc-的频率"}},[s._v("#")]),s._v(" 11.7.1 降低 Full GC 的频率")]),s._v(" "),a("p",[s._v("由于堆内存空间不足或老年代对象太多，会触发 Full GC，频繁的 Full GC 会带来上下文切换，增加系统的性能开销。")]),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[a("strong",[s._v("减少创建大对象")])]),s._v("：在平常的业务场景中，我们一次性从数据库中查询出一个大对象用于 web 端显示。比如，一次性查询出 60 个字段的业务操作，这种大对象如果超过年轻代最大对象阈值，会被直接创建在老年代；即使被创建在了年轻代，由于年轻代的内存空间有限，通过 Minor GC 之后也会进入到老年代。这种大对象很容易产生较多的 Full GC。")],1),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[a("strong",[s._v("增大堆内存空间")])]),s._v("：在堆内存不足的情况下，增大堆内存空间，且设置初始化堆内存为最大堆内存，也可以降低 Full GC 的频率。")],1),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[a("strong",[s._v("选择合适的 GC 回收器")])]),s._v(": 如果要求每次操作的响应时间必须在 500ms 以内。这个时候我们一般会选择响应速度较快的 GC 回收器，堆内存比较小的情况下（<6G）选择 CMS （Concurrent Mark Sweep）回收器和堆内存比较大的情况下（>8G）G1 回收器.")],1)])}),[],!1,null,null,null);t.default=e.exports}}]);