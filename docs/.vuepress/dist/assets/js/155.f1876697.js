(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{1482:function(t,s,a){"use strict";a.r(s);var r=a(26),o=Object(r.a)({},(function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"_1-consul简介"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-consul简介"}},[t._v("#")]),t._v(" 1. Consul简介")]),t._v(" "),r("p",[t._v("Consul 是 HashiCorp 公司推出的开源工具，用于实现分布式系统的服务发现与配置。与其它分布式服务注册与\n发现的方案，Consul 的方案更“一站式”，内置了服务注册与发现框架、分布一致性协议实现、健康检查、Key/Value\n存储、多数据中心方案，不再需要依赖其它工具（比如 ZooKeeper 等），使用起来也较为简单。")]),t._v(" "),r("p",[t._v("Consul 使用 Go 语言编写，因此具有天然可移植性（支持Linux、Windows 和 Mac OS）；安装包仅包含一个可\n执行文件，方便部署，与 Docker 等轻量级容器可无缝配合。")]),t._v(" "),r("h2",{attrs:{id:"_1-1-consul功能特性"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-consul功能特性"}},[t._v("#")]),t._v(" 1.1 Consul功能特性")]),t._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[t._v("Consul功能特性")]),t._v(" "),r("ol",[r("li",[t._v("Raft 算法")]),t._v(" "),r("li",[t._v("服务发现")]),t._v(" "),r("li",[t._v("健康检查")]),t._v(" "),r("li",[t._v("Key/Value 存储")]),t._v(" "),r("li",[t._v("多数据中心")]),t._v(" "),r("li",[t._v("支持 http 和 dns 协议接口")]),t._v(" "),r("li",[t._v("官方提供 web 管理界面")])])]),t._v(" "),r("h3",{attrs:{id:"_1-1-1-consul-角色"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-consul-角色"}},[t._v("#")]),t._v(" 1.1.1 Consul 角色")]),t._v(" "),r("ol",[r("li",[r("p",[r("strong",[t._v("client：客户端")]),t._v("，无状态，将 HTTP 和 DNS 接口请求转发给局域网内的服务端集群。")])]),t._v(" "),r("li",[r("p",[r("strong",[t._v("server：服务端")]),t._v("，保存配置信息，高可用集群，每个数据中心的 server 数量推荐为 3 个或者 5 个。")])])]),t._v(" "),r("p",[r("a",{attrs:{"data-fancybox":"",title:"Consul 角色",href:"./image/consul01.jpg"}},[r("img",{attrs:{src:a(807),alt:"Consul 角色"}})])]),t._v(" "),r("h3",{attrs:{id:"_1-1-2-consul-工作原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-consul-工作原理"}},[t._v("#")]),t._v(" 1.1.2 Consul 工作原理")]),t._v(" "),r("p",[r("a",{attrs:{"data-fancybox":"",title:"Consul 服务发现以及注册",href:"./image/consul02.jpg"}},[r("img",{attrs:{src:a(808),alt:"Consul 服务发现以及注册"}})])]),t._v(" "),r("h4",{attrs:{id:"服务发现以及注册"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#服务发现以及注册"}},[t._v("#")]),t._v(" 服务发现以及注册")]),t._v(" "),r("p",[t._v("当服务 Producer 启动时，会将自己的 Ip/host 等信息通过发送请求告知 Consul，Consul 接收到 Producer 的\n注册信息后，每隔 10s（默认）会向 Producer 发送一个健康检查的请求，检验 Producer 是否健康。")]),t._v(" "),r("h4",{attrs:{id:"服务调用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#服务调用"}},[t._v("#")]),t._v(" 服务调用")]),t._v(" "),r("p",[t._v("当 Consumer 请求 Product 时，会先从 Consul 中拿到存储 Product 服务的 IP 和 Port 的临时表(temp table)， 从temp table 表中任选一个· Producer 的 IP 和 Port， 然后根据这个 IP 和 Port，发送问请求；temp table 表只\n包含通过了健康检查的 Producer 信息，并且每隔 10s（默认）更新。")])])}),[],!1,null,null,null);s.default=o.exports},807:function(t,s,a){t.exports=a.p+"assets/img/consul01.9b953f9a.jpg"},808:function(t,s,a){t.exports=a.p+"assets/img/consul02.ee17570c.jpg"}}]);