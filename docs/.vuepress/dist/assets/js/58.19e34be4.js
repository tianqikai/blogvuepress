(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{685:function(s,a,t){s.exports=t.p+"assets/img/els.72ff9c9b.jpg"},686:function(s,a,t){s.exports=t.p+"assets/img/kibana.30a3fabd.jpg"},825:function(s,a,t){"use strict";t.r(a);var n=t(26),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"_7-docker安装elasticsearch、kibana"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-docker安装elasticsearch、kibana"}},[s._v("#")]),s._v(" 7 Docker安装Elasticsearch、Kibana")]),s._v(" "),n("h2",{attrs:{id:"_7-1-下载elasticsearch、kibana镜像文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-下载elasticsearch、kibana镜像文件"}},[s._v("#")]),s._v(" 7.1 下载Elasticsearch、Kibana镜像文件")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 存储和检索数据")]),s._v("\ndocker pull elasticsearch:7.4.2\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可视化检索数据")]),s._v("\ndocker pull kibana:7.4.2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"_7-2-启动elasticsearch"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-启动elasticsearch"}},[s._v("#")]),s._v(" 7.2 启动Elasticsearch")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置挂载数据文件夹")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建配置文件目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /mydata/elasticsearch/config\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /mydata/elasticsearch/data\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将/mydata/elasticsearch/文件夹中文件都可读可写（必须是777）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -R "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /mydata/elasticsearch/\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置任意机器可以访问 elasticsearch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http.host: 0.0.0.0"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/mydata/elasticsearch/config/elasticsearch.yml\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#命令后面的 \\是换行符，注意前面有空格")]),s._v("\n\ndocker run --name elasticsearch -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xms512m -Xmx512m"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/elasticsearch/data:/usr/share/elasticsearch/data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v  /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d elasticsearch:7.4.2 \n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("参数介绍")]),s._v(" "),n("p",[n("font",{attrs:{color:"red"}},[n("strong",[s._v("-p 9200:9200 -p 9300:9300")])]),s._v("：向外暴露两个端口，9200用于HTTP REST API请求，9300 ES 在分布式集群状态下 ES 之间的通信端口；"),n("br"),s._v(" "),n("font",{attrs:{color:"red"}},[n("strong",[s._v('-e  "discovery.type=single-node"')])]),s._v("：es 以单节点运行"),n("br"),s._v(" "),n("font",{attrs:{color:"red"}},[n("strong",[s._v('-e ES_JAVA_OPTS="-Xms64m -Xmx512m"')])]),s._v("：设置启动占用内存，不设置可能会占用当前系统所有内存"),n("br"),s._v(" "),n("font",{attrs:{color:"red"}},[n("strong",[s._v("-v")])]),s._v("：挂载容器中的配置文件、数据文件、插件数据到本机的文件夹；"),n("br"),s._v(" "),n("font",{attrs:{color:"red"}},[n("strong",[s._v("-d elasticsearch:7.6.2")])]),s._v("：指定要启动的镜像")],1)]),s._v(" "),n("p",[n("strong",[s._v("访问 http://49.233.34.168:9200 看到返回的 json 数据说明启动成功")])]),s._v(" "),n("p",[n("a",{attrs:{"data-fancybox":"",title:"elasticsearch",href:"./image/els.jpg"}},[n("img",{attrs:{src:t(685),alt:"elasticsearch"}})])]),s._v(" "),n("h2",{attrs:{id:"_7-3-启动可视化kibana"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-启动可视化kibana"}},[s._v("#")]),s._v(" 7.3 启动可视化Kibana")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("docker run --name kibana "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ELASTICSEARCH_HOSTS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://49.233.34.168:9200 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v(":5601 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d kibana:7.4.2 \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-e ELASTICSEARCH_HOSTS=http://49.233.34.168:9200  这里的ip要设置成自己的虚拟机IP地址")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("浏览器输入http://49.233.34.168:5601 测试")])]),s._v(" "),n("p",[n("a",{attrs:{"data-fancybox":"",title:"启动可视化Kibana",href:"./image/kibana.jpg"}},[n("img",{attrs:{src:t(686),alt:"启动可视化Kibana"}})])]),s._v(" "),n("h2",{attrs:{id:"_7-4-设置-elasticsearch、kibana-随docker启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-设置-elasticsearch、kibana-随docker启动"}},[s._v("#")]),s._v(" 7.4 设置 Elasticsearch、Kibana 随Docker启动")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前 Docker 开机自启，所以 ES 现在也是开机自启")]),s._v("\ndocker update elasticsearch --restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前 Docker 开机自启，所以 kibana 现在也是开机自启")]),s._v("\ndocker update kibana --restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);