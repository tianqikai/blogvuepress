(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{1268:function(s,a,n){s.exports=n.p+"assets/img/image-20201012090431772.93a428c7.png"},1269:function(s,a,n){s.exports=n.p+"assets/img/image-20201012091133753.60f28775.png"},1270:function(s,a,n){s.exports=n.p+"assets/img/image-20201012091656779.1d31684f.png"},1271:function(s,a,n){s.exports=n.p+"assets/img/image-20201012093751081.c19e3fd4.png"},1272:function(s,a,n){s.exports=n.p+"assets/img/nginx02.7fc06385.jpg"},1634:function(s,a,n){"use strict";n.r(a);var t=n(26),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_1-nginx简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx简介"}},[s._v("#")]),s._v(" 1. Nginx简介")]),s._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#_1-1-nginx概述"}},[s._v("1.1 Nginx概述")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1-1-1-什么是nginx"}},[s._v("1.1.1 什么是Nginx")])])])]),t("li",[t("a",{attrs:{href:"#_1-2-nginx应用场景"}},[s._v("1.2 Nginx应用场景")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1-2-1-正向代理"}},[s._v("1.2.1 正向代理")])]),t("li",[t("a",{attrs:{href:"#_1-2-2-反向代理"}},[s._v("1.2.2 反向代理")])]),t("li",[t("a",{attrs:{href:"#_1-2-3-负载均衡"}},[s._v("1.2.3 负载均衡")])]),t("li",[t("a",{attrs:{href:"#_1-2-4-动静分离"}},[s._v("1.2.4 动静分离")])])])]),t("li",[t("a",{attrs:{href:"#_1-3-openresty来安装nginx"}},[s._v("1.3 openresty来安装nginx")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1-3-1-检查是否安装perl环境"}},[s._v("1.3.1 检查是否安装Perl环境")])]),t("li",[t("a",{attrs:{href:"#_1-3-3-创建文件制作-自动安装脚本"}},[s._v("1.3.3 创建文件制作自动安装脚本")])])])]),t("li",[t("a",{attrs:{href:"#_1-4-官网安装包安装nginx"}},[s._v("1.4 官网安装包安装nginx")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1-4-1-创建安装脚本"}},[s._v("1.4.1 创建安装脚本")])]),t("li",[t("a",{attrs:{href:"#_1-4-2-日志备份脚本"}},[s._v("1.4.2 日志备份脚本")])]),t("li",[t("a",{attrs:{href:"#_1-4-3-nginx安装图片压缩模块"}},[s._v("1.4.3 nginx安装图片压缩模块")])]),t("li",[t("a",{attrs:{href:"#_1-4-4-ssl证书安装"}},[s._v("1.4.4 ssl证书安装")])])])])])]),t("p"),s._v(" "),t("h2",{attrs:{id:"_1-1-nginx概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-nginx概述"}},[s._v("#")]),s._v(" 1.1 Nginx概述")]),s._v(" "),t("p",[s._v("Nginx官网  https://www.nginx.com/")]),s._v(" "),t("p",[s._v("Nginx 是一款高性能的HTTP服务器和反"),t("strong",[s._v("向代理服务器")]),s._v("，同时支持"),t("strong",[s._v("IMAP/POP3/SMTP")]),s._v("代理服务")]),s._v(" "),t("h3",{attrs:{id:"_1-1-1-什么是nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-什么是nginx"}},[s._v("#")]),s._v(" 1.1.1 什么是Nginx")]),s._v(" "),t("p",[s._v("Nginx 是一款高性能的 http 服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器。由俄罗斯的程序设计师伊戈尔·西索夫（Igor Sysoev）所开发，官方测试 nginx 能够支支撑 5 万并发链接， 并且 cpu、内存等资源消耗却非常低，运行非常稳定。 由C语言编写")]),s._v(" "),t("h2",{attrs:{id:"_1-2-nginx应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-nginx应用场景"}},[s._v("#")]),s._v(" 1.2 Nginx应用场景")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("Nginx应用场景")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("http服务器")]),s._v(",Nginx 是一个 http 服务可以独立提供 http 服务。可以做"),t("strong",[s._v("网页静态服务器")]),s._v("。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("虚拟主机")]),s._v(",可以实现在一台服务器虚拟出多个网站。例如个人网站使用的虚拟主机。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("反向代理，负载均衡")]),s._v(",当网站的访问量达到一定程度后，单台服务器不能满足用户的请求时，需要用多台服务器集群可以使用 nginx 做反向代理。并且多台服务器可以平均分担负载，不会因为某台服务器负载高宕机而某台服务器闲置的情况。")])])])]),s._v(" "),t("h3",{attrs:{id:"_1-2-1-正向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-正向代理"}},[s._v("#")]),s._v(" 1.2.1 正向代理")]),s._v(" "),t("p",[s._v("弄清楚什么是代理了，那么什么又是正向代理呢？")]),s._v(" "),t("p",[s._v("这里我再举一个例子：大家都知道，现在国内是访问不了 Google的，那么怎么才能访问 Google呢？我们又想，美国人不是能访问 Google吗（这不废话，Google就是美国的），如果我们电脑的对外公网 IP 地址能变成美国的 IP 地址，那不就可以访问 Google了。你很聪明，VPN 就是这样产生的。我们在访问 Google 时，先连上 VPN 服务器将我们的 IP 地址变成美国的 IP 地址，然后就可以顺利的访问了。")]),s._v(" "),t("p",[s._v("这里的 VPN 就是做正向代理的。正向代理服务器位于客户端和服务器之间，为了向服务器获取数据，客户端要向代理服务器发送一个请求，并指定目标服务器，代理服务器将目标服务器返回的数据转交给客户端。这里客户端是要进行一些正向代理的设置的。")]),s._v(" "),t("p",[t("img",{attrs:{src:n(1268),alt:"image-20201012090431772"}})]),s._v(" "),t("h3",{attrs:{id:"_1-2-2-反向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-反向代理"}},[s._v("#")]),s._v(" 1.2.2 反向代理")]),s._v(" "),t("p",[s._v("反向代理，其实客户端对代理是无感知的，因为客户端不需要任何配置就可以访问，我们只需要将请求发送到反向代理服务器，由反向代理服务器去选择目标服务器获取数据后，在返回给客户端，此时反向代理服务器和目标服务器对外就是一个服务器，暴露的是代理服务器地址，隐藏了真实服务器IP地址。")]),s._v(" "),t("p",[s._v("反向代理和正向代理的区别就是："),t("strong",[s._v("正向代理代理客户端，反向代理代理服务器。")])]),s._v(" "),t("p",[s._v("反向代理，其实客户端对代理是无感知的，因为客户端不需要任何配置就可以访问，我们只需要将请求发送到反向代理服务器，由反向代理服务器去选择目标服务器获取数据后，在返回给客户端，此时反向代理服务器和目标服务器对外就是一个服务器，暴露的是代理服务器地址，隐藏了真实服务器IP地址。")]),s._v(" "),t("p",[s._v("理解这两种代理的关键在于代理服务器所代理的对象是什么，正向代理代理的是客户端，我们需要在客户端进行一些代理的设置。而反向代理代理的是服务器，作为客户端的我们是无法感知到服务器的真实存在的。")]),s._v(" "),t("p",[s._v("总结起来还是一句话："),t("strong",[s._v("正向代理代理客户端，反向代理代理服务器。")])]),s._v(" "),t("p",[t("img",{attrs:{src:n(1269),alt:"image-20201012091133753"}})]),s._v(" "),t("h3",{attrs:{id:"_1-2-3-负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-负载均衡"}},[s._v("#")]),s._v(" 1.2.3 负载均衡")]),s._v(" "),t("p",[s._v("客户端发送多个请求到服务器，服务器处理请求，有一些可能要与数据库进行交互，服务器处理完毕后，再将结果返回给客户端。")]),s._v(" "),t("p",[s._v("这种架构模式对于早期的系统相对单一，并发请求相对较少的情况下是比较适合的，成本也低。但是随着信息数量的不断增长，访问量和数据量的飞速增长，以及系统业务的复杂度增加，这种架构会造成服务器相应客户端的请求日益缓慢，并发量特别大的时候，还容易造成服务器直接崩溃。很明显这是由于服务器性能的瓶颈造成的问题，那么如何解决这种情况呢？")]),s._v(" "),t("p",[s._v("我们首先想到的可能是升级服务器的配置，比如提高CPU执行频率，加大内存等提高机器的物理性能来解决此问题，但是我们知道摩尔定律的日益失效，硬件的性能提升已经不能满足日益提升的需求了。最明显的一个例子，天猫双十一当天，某个热销商品的瞬时访问量是极其庞大的，那么类似上面的系统架构，将机器都增加到现有的顶级物理配置，都是不能够满足需求的。那么怎么办呢？")]),s._v(" "),t("p",[s._v("上面的分析我们去掉了增加服务器物理配置来解决问题的办法，也就是说纵向解决问题的办法行不通了，那么横向增加服务器的数量呢？这时候集群的概念产生了，单个服务器解决不了，我们增加服务器的数量，然后将请求分发到各个服务器上**，将原先请求集中到单个服务器上的情况改为将请求分发到多个服务器上，将负载分发到不同的服务器，也就是我们所说的负载均衡**")]),s._v(" "),t("p",[t("img",{attrs:{src:n(1270),alt:"image-20201012091656779"}})]),s._v(" "),t("h3",{attrs:{id:"_1-2-4-动静分离"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4-动静分离"}},[s._v("#")]),s._v(" 1.2.4 动静分离")]),s._v(" "),t("p",[s._v("为了加快网站的解析速度，可以把动态页面和静态页面由不同的服务器来解析，加快解析速度。降低原来单个服务器的压力")]),s._v(" "),t("p",[t("img",{attrs:{src:n(1271),alt:"image-20201012093751081"}})]),s._v(" "),t("h2",{attrs:{id:"_1-3-openresty来安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-openresty来安装nginx"}},[s._v("#")]),s._v(" 1.3 openresty来安装nginx")]),s._v(" "),t("h3",{attrs:{id:"_1-3-1-检查是否安装perl环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-检查是否安装perl环境"}},[s._v("#")]),s._v(" 1.3.1 检查是否安装Perl环境")]),s._v(" "),t("p",[s._v("不安装会报错\n"),t("strong",[s._v("you may need to install the Temp module")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" perl\n\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" cpan\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查是否安装成功")]),s._v("\nperl -V\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"_1-3-3-创建文件制作自动安装脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-创建文件制作自动安装脚本"}},[s._v("#")]),s._v(" 1.3.3 创建文件制作"),t("strong",[s._v("自动安装脚本")])]),s._v(" "),t("p",[s._v("vim  openresty.sh")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y pcre-devel openssl-devel gcc "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://openresty.org/download/openresty-1.17.8.2.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf openresty-1.17.8.2.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" openresty-1.17.8.2 openresty\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/openresty/\n ./configure --with-luajit "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            --without-http_redis2_module "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            --with-http_iconv_module\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/openresty/ \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("ol",[t("li",[s._v("赋予执行文件")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x openresty.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("运行即可")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("./openresty.sh \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("修改环境")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/profile\n \n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/openresty/nginx/sbin:"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("至此结束 配置完成,启动nginx")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/openresty/nginx/sbin\n\n \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#> 1、启动命令")]),s._v("\n ./nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#> 2、关闭命令")]),s._v("\n\n ./nginx -s stop\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#> 3、重新加载命令")]),s._v("\n./nginx -s reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[t("a",{attrs:{"data-fancybox":"",title:"启动nginx",href:"./image/nginx02.jpg"}},[t("img",{attrs:{src:n(1272),alt:"启动nginx"}})])]),s._v(" "),t("p",[s._v("这个脚本可以复用,下次直接赋予执行文件配置 环境即可")]),s._v(" "),t("h2",{attrs:{id:"_1-4-官网安装包安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-官网安装包安装nginx"}},[s._v("#")]),s._v(" 1.4 官网安装包安装nginx")]),s._v(" "),t("h3",{attrs:{id:"_1-4-1-创建安装脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-创建安装脚本"}},[s._v("#")]),s._v(" 1.4.1 创建安装脚本")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[s._v("\nvi nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh\n\n#"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bash\n#一键安装上面四个依赖\nyum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y install gcc zlib zlib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("devel pcre"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("devel openssl openssl"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("devel\n\n#创建一个文件夹\ncd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local\n\n#下载tar包\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("wget")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")])]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//nginx.org/download/nginx-1.13.7.tar.gz")])]),s._v("\nwget http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//nginx.org/download/nginx-1.16.0.tar.gz")]),s._v("\n\n#解压安装包\ntar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xzvf nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n\n#修改路径\nmv  nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  nginx\n\ncd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("configure "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n# 编译\nmake "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" make install\n\n#启动nginx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx \n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"_1-4-2-日志备份脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-日志备份脚本"}},[s._v("#")]),s._v(" 1.4.2 日志备份脚本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LOGS_PATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/logs/oldlogs\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CUR_LOGS_PATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/logs\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("YESTERDAY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CUR_LOGS_PATH")]),s._v("/access.log  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LOGS_PATH")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${YESTERDAY}")]),s._v("_access.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CUR_LOGS_PATH")]),s._v("/_access.log  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LOGS_PATH")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${YESTERDAY}")]),s._v("_access_bak.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CUR_LOGS_PATH")]),s._v("/error.log  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LOGS_PATH")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${YESTERDAY}")]),s._v("_error.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CUR_LOGS_PATH")]),s._v("/_error.log  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LOGS_PATH")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${YESTERDAY}")]),s._v("_error_bak.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -USR1 "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /usr/local/nginx/logs/nginx.pid"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("hr"),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加定时任务处理")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -e\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * * * /usr/local/nginx/logs/backup.sh\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -l 查看\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_1-4-3-nginx安装图片压缩模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-nginx安装图片压缩模块"}},[s._v("#")]),s._v(" 1.4.3 nginx安装图片压缩模块")]),s._v(" "),t("h4",{attrs:{id:"_1-4-3-1-安装图片压缩模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-1-安装图片压缩模块"}},[s._v("#")]),s._v(" 1.4.3.1 安装图片压缩模块")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/nginx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#GD library安装命令：")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gd-devel   //centos7系统\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#apt-get install libgd2-xpm libgd2-xpm-dev   Ubuntu系统")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##----不安装报以下错误")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PS: HttpImageFilterModule模块需要依赖gd-devel的支持，可以使用yum或apt-get方便地安装，如果未安装回报“/configure: error:the HTTP image filter module requires the GD library.”错误")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装命令：")]),s._v("\n./configure   --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx  --with-http_image_filter_module"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dynamic\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭nginx")]),s._v("\nsystemctl stop nginx\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/nginx/objs\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ./nginx  /usr/local/nginx/sbin/nginx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将动态库文件放在一个固定目录下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ngx_http_image_filter_module.so  /usr/local/nginx/moudles/\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("hr"),s._v(" "),t("h4",{attrs:{id:"_1-4-3-2-检查图片压缩模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-2-检查图片压缩模块"}},[s._v("#")]),s._v(" 1.4.3.2 检查图片压缩模块")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看nginx版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("V  \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看image模块 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("configure "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("help"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" grep image\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//回显信息")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("with"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http_image_filter_module    enable ngx_http_image_filter_module\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("with"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http_image_filter_module"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dynamic\n                                     enable dynamic ngx_http_image_filter_module\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"_1-4-3-3-nginx配置实例-动静分离"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-3-nginx配置实例-动静分离"}},[s._v("#")]),s._v(" 1.4.3.3 Nginx配置实例-动静分离")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /usr/local/nginx/conf/nginx.conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局内配置")]),s._v("\nload_module "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"moudles/ngx_http_image_filter_module.so"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# server http内配置")]),s._v("\nlocation /images/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    root /root/ftpadmin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#root 能够让访问 /images/ 路径时，访问到 /User/XX/Desktop/images，")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果将 root 替换为 alias，则访问的是 /User/XX/Desktop/；其中 /User/XX/Desktop/ 是本机中的绝对路径。")]),s._v("\n    autoindex on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#打开目录浏览功能")]),s._v("\n    image_filter   resize  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新加载配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# nginx: [error] open() "/usr/local/nginx/logs/nginx.pid" failed (2: No such file or directory)')]),s._v("\n/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  重启")]),s._v("\n/usr/local/nginx/sbin/nginx  -s reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h3",{attrs:{id:"_1-4-4-ssl证书安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-4-ssl证书安装"}},[s._v("#")]),s._v(" 1.4.4 ssl证书安装")]),s._v(" "),t("h4",{attrs:{id:"_1-4-4-1-ssl证书模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-4-1-ssl证书模块"}},[s._v("#")]),s._v(" 1.4.4.1 SSL证书模块")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!bin/bash ")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/nginx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 openssl-devel")]),s._v("\nyum  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  -y  openssl-devel\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装httpssl证书模块   ")]),s._v("\n./configure   --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx  --with-http_image_filter_module"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dynamic --with-http_ssl_module\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#编译 使用")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭nginx")]),s._v("\nsystemctl stop nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看 objs目录查看编译好的文件 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/nginx/objs\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ./nginx  /usr/local/nginx/sbin/nginx\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h4",{attrs:{id:"_1-4-4-2-修改nginx-conf配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-4-2-修改nginx-conf配置文件"}},[s._v("#")]),s._v(" 1.4.4.2 修改nginx.conf配置文件")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("./configure --help"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" ssl\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/nginx/conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看公钥秘钥存放路径--/usr/local/nginx/conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -lrt\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3925")]),s._v(" May "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":13 1_tianqikai.club_bundle.crt\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1678")]),s._v(" May "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":13 2_tianqikai.club.key\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /usr/local/nginx/conf/nginx.conf\nserver "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SSL 访问端口号为 443")]),s._v("\n     listen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" ssl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#填写绑定证书的域名")]),s._v("\n     server_name tianqikai.club"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#证书文件名称")]),s._v("\n     ssl_certificate 1_tianqikai.club_bundle.crt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#私钥文件名称")]),s._v("\n     ssl_certificate_key 2_tianqikai.club.key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n     ssl_session_timeout 5m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#请按照以下协议配置")]),s._v("\n     ssl_protocols TLSv1 TLSv1.1 TLSv1.2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。")]),s._v("\n     ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("aNULL:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("MD5:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("RC4:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DHE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n     ssl_prefer_server_ciphers on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     location / "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#网站主页路径。此路径仅供参考，具体请您按照实际目录操作。")]),s._v("\n         root /var/www/tianqikai.club"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n         index  index.html index.htm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新加载配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# nginx: [error] open() "/usr/local/nginx/logs/nginx.pid" failed (2: No such file or directory)')]),s._v("\n/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  重启")]),s._v("\n/usr/local/nginx/sbin/nginx  -s reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br")])]),t("h4",{attrs:{id:"_1-4-4-3-ab压测工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-4-3-ab压测工具"}},[s._v("#")]),s._v(" 1.4.4.3 AB压测工具")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" httpd-tools\n\nab -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   http://49.233.34.168/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -c 10表示并发用户数为10")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -n 100表示请求总数为100")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);