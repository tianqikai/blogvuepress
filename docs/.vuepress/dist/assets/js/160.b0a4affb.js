(window.webpackJsonp=window.webpackJsonp||[]).push([[160],{1105:function(s,a,t){"use strict";t.r(a);var n=t(26),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_5-docker容器数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-docker容器数据卷"}},[s._v("#")]),s._v(" 5. Docker容器数据卷")]),s._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#_5-1-docker容器数据卷是什么"}},[s._v("5.1 Docker容器数据卷是什么")])]),t("li",[t("a",{attrs:{href:"#_5-2-容器数据卷作用"}},[s._v("5.2 容器数据卷作用")])]),t("li",[t("a",{attrs:{href:"#_5-3-指定目录挂载"}},[s._v("5.3 指定目录挂载")])]),t("li",[t("a",{attrs:{href:"#_5-4-匿名挂载"}},[s._v("5.4 匿名挂载")])]),t("li",[t("a",{attrs:{href:"#_5-5-具名挂载"}},[s._v("5.5 具名挂载")])]),t("li",[t("a",{attrs:{href:"#_5-6-挂载只读和读写权限"}},[s._v("5.6 挂载只读和读写权限")])]),t("li",[t("a",{attrs:{href:"#_5-7-继承目录卷-volumes-from"}},[s._v("5.7 继承目录卷(--volumes-from)")])]),t("li",[t("a",{attrs:{href:"#_5-8-dockerfile添加"}},[s._v("5.8 DockerFile添加")]),t("ul",[t("li",[t("a",{attrs:{href:"#_5-8-1-创建dockerfile文件"}},[s._v("5.8.1 创建Dockerfile文件")])]),t("li",[t("a",{attrs:{href:"#_5-8-2-执行dockerfile文件"}},[s._v("5.8.2 执行dockerfile文件")])]),t("li",[t("a",{attrs:{href:"#_5-8-3-启动刚才创建的容器"}},[s._v("5.8.3 启动刚才创建的容器")])])])])])]),t("p"),s._v(" "),t("h2",{attrs:{id:"_5-1-docker容器数据卷是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-docker容器数据卷是什么"}},[s._v("#")]),s._v(" 5.1 Docker容器数据卷是什么")]),s._v(" "),t("p",[s._v("先来看看"),t("strong",[s._v("Docker")]),s._v("的理念:")]),s._v(" "),t("ol",[t("li",[s._v("将运用与运行的环境打包形成容器运行，运行可以伴随着容器，但是我们对数据的要求希望是持久化的")]),s._v(" "),t("li",[s._v("容器之间希望有可能共享数据")])]),s._v(" "),t("p",[t("strong",[s._v("Docker")]),s._v("容器产生的数据，如果不通过"),t("strong",[s._v("docker commit")]),s._v("生成新的镜像，使得数据做为镜像的一部分保存下来，\n那么当容器删除后，数据自然也就没有了。\n为了能保存数据在docker中我们使用"),t("strong",[s._v("容器数据卷")]),s._v("。|")]),s._v(" "),t("p",[s._v("一句话：有点类似我们Redis里面的rdb和aof文件")]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"_5-2-容器数据卷作用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-容器数据卷作用"}},[s._v("#")]),s._v(" 5.2 容器数据卷作用")]),s._v(" "),t("p",[s._v("卷就是目录或文件，存在于一个或多个容器中，由"),t("strong",[s._v("docker")]),s._v("挂载到容器，但不属于"),t("strong",[s._v("联合文件系统")]),s._v("，因此能够绕过Union FileSystem提供一些用于持续存储或共享数据的特性:\n卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂载的数据卷")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("特点:")]),s._v(" "),t("ol",[t("li",[s._v("数据卷可在容器之间共享或重用数据")]),s._v(" "),t("li",[s._v("卷中的更改可以直接生效")]),s._v(" "),t("li",[s._v("数据卷中的更改不会包含在镜像的更新中")]),s._v(" "),t("li",[s._v("数据卷的生命周期一直持续到没有容器使用它为止")])])]),s._v(" "),t("p",[t("strong",[s._v("容器的持久化")]),t("br"),s._v(" "),t("strong",[s._v("容器间继承+共享数据")])]),s._v(" "),t("h2",{attrs:{id:"_5-3-指定目录挂载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-指定目录挂载"}},[s._v("#")]),s._v(" 5.3 指定目录挂载")]),s._v(" "),t("p",[t("strong",[s._v("-v /宿主机路径：容器内路径")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("\ndocker run -it -v /宿主机绝对路径目录:/容器内目录 镜像名\n\ndocker run -it -d -v /mydata/logs:/usr/local/tomcat/logs  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8080 590715041a56\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据卷是否挂载成功")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect  容器")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO2 logs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect  c0b1399e3fd6|grep mydata")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/logs:/usr/local/tomcat/logs"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/logs"')]),s._v(",\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mounts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bind"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/logs"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Destination"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/tomcat/logs"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mode"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RW"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Propagation"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rprivate"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h2",{attrs:{id:"_5-4-匿名挂载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-匿名挂载"}},[s._v("#")]),s._v(" 5.4 匿名挂载")]),s._v(" "),t("p",[t("strong",[s._v("-v 容器内路径")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("docker run -it -d -v /usr/local/tomcat/logs  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111")]),s._v(":8080 590715041a56\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看挂在容器卷  默认在/var/lib/docker/volumes下边的路径")]),s._v("\ndocker inspect adb93530b509\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"_5-5-具名挂载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-具名挂载"}},[s._v("#")]),s._v(" 5.5 具名挂载")]),s._v(" "),t("p",[t("strong",[s._v("-v 数据卷名：容器内路径")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("docker run -it -d -v mylog:/usr/local/tomcat/logs  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2222")]),s._v(":8080 590715041a56\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看挂在容器卷  默认在/var/lib/docker/volumes下边的路径")]),s._v("\ndocker volumn inspect mylog\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO2 etc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume inspect mylog")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CreatedAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-10-07T19:47:52+08:00"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mountpoint"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/mylog/_data"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mylog"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h2",{attrs:{id:"_5-6-挂载只读和读写权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-挂载只读和读写权限"}},[s._v("#")]),s._v(" 5.6 挂载只读和读写权限")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#命令(带权限)")]),s._v("\n\n​"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /宿主机绝对路径目录:/容器内目录**:ro** 镜像名")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只读权限")]),s._v("\ndocker run -it -d -v /mydata/logs:/usr/local/tomcat/logs:ro  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8080 590715041a56\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#读写权限")]),s._v("\ndocker run -it -d -v /mydata/logs:/usr/local/tomcat/logs:rw  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8080 590715041a56\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@TXYUN-NO2 logs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect  c0b1399e3fd6|grep mydata")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/logs:/usr/local/tomcat/logs"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/logs"')]),s._v(",\n\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mounts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bind"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/logs"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Destination"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/tomcat/logs"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mode"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ro"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RW"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Propagation"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rprivate"')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("h2",{attrs:{id:"_5-7-继承目录卷-volumes-from"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-继承目录卷-volumes-from"}},[s._v("#")]),s._v(" 5.7 继承目录卷(--volumes-from)")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker run -it -d   -v dataVolumeContainer:/usr/local/tomcat/logs  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5555")]),s._v(":8080  --name tomcat11 590715041a56\ndocker run -it -d   -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5556")]),s._v(":8080  --name tomcat12 --volumes-from tomcat11 590715041a56\ndocker run -it -d   -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5557")]),s._v(":8080  --name tomcat13 --volumes-from tomcat11 590715041a56\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_5-8-dockerfile添加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-dockerfile添加"}},[s._v("#")]),s._v(" 5.8 DockerFile添加")]),s._v(" "),t("h3",{attrs:{id:"_5-8-1-创建dockerfile文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-1-创建dockerfile文件"}},[s._v("#")]),s._v(" 5.8.1 创建Dockerfile文件")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建议使用Dockerfile作为文件名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Dockerfile\n\nFROM tomcat:8.5.0\nVOLUME "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/mylogs01"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mydata/mylogs02"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nCMD "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"finished,-----------success"')]),s._v("\nCMD /bin/bash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("DockerFile命令说明")]),s._v(" "),t("p",[s._v("FROM  来自于一个父类的镜像")]),s._v(" "),t("p",[s._v("VOLUME  给镜像添加一个或多个容器卷")]),s._v(" "),t("p",[s._v("CMD  控制台执行的命令")])]),s._v(" "),t("h3",{attrs:{id:"_5-8-2-执行dockerfile文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-2-执行dockerfile文件"}},[s._v("#")]),s._v(" 5.8.2 执行dockerfile文件")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("$ docker build -f Dockerfile -t tqk001/tomcat "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -f 指定dockerfile的路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -t target 指定目标，镜像的名称(不能以/开头)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后的.不能忽略，表示输出的目录")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_5-8-3-启动刚才创建的容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-3-启动刚才创建的容器"}},[s._v("#")]),s._v(" 5.8.3 启动刚才创建的容器")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker run -it --name tomcat01 -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7777")]),s._v(":8080 tqk001/tomcat /bin/bash\ndocker run -it  -d --name tomcat02 --volumes-from tomcat01 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8080 tqk001/tomcat /bin/bash\ndocker run -it  -d --name tomcat03 --volumes-from tomcat01 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v(":8080 tqk001/tomcat /bin/bash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("注意")])]),s._v(" "),t("p",[s._v("Docker挂载主机目录Docker访问出现cannot open directory . Permission denied"),t("br"),s._v("\n解决办法:在挂载目录后多加一个--privileged=true参数即可")])])}),[],!1,null,null,null);a.default=e.exports}}]);