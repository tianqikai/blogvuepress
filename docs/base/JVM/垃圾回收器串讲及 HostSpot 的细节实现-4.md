# 5. 垃圾回收器串讲及 HostSpot 的细节实现（JVM 面试"核武器"）

## 5.1 并发标记

在三色标记法之前有一个算法叫 **Mark-And-Sweep（标记清除）**
这个算法会设置一个标志位来记录对象是否被使用。最开始所有的标记位都是 0，如果发现对象是可达的就会置为 1，一步步下去就会呈现一个类似树状的结果。等标记的步骤完成后，会将未被标记的对象统一清理，再次把所有的标记位设置成 0 方便下次清理。 

这个算法最大的问题是 **GC 执行期间需要把整个程序完全暂停，不能异步进行 GC 操作**。因为在不同阶段标记清扫法的标志位 0 和 1 有不同的含义， 那么新增的对象无论标记为什么都有可能意外删除这个对象。

对实时性要求高的系统来说，这种需要长时间挂起的标记清扫法是不可接受的。所以就需要一个算法来解决 GC 运行时程序长时间挂起的问题，那就三色标记法。 

**三色标记最大的好处是可以异步执行，从而可以以中断时间极少的代价或者完全没有中断来进行整个GC** 

三色标记法很简单。首先将对象用三种颜色表示，分别是白色、灰色和黑色。 
**黑色**：根对象，或者该对象与它的子对象都被扫描过。 
**灰色**：对本身被扫描，但是还没扫描完该对象的子对象。 
**白色**：未被扫描对象，如果扫描完所有对象之后，最终为白色的为不可达对象，既垃圾对象。

## 5.2 三色标记




